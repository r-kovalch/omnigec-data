from src.prompts.base_prompts import BasePrompt


class MultiGrammarErrorCorrectionGenerationPrompt(BasePrompt):
    template: str = """Виправте наступний текст, зробивши його граматично правильним.
Виправте всі орфографічні, пунктуаційні, стилістичні, граматичні, лексичні та синтаксичні помилки.
Якщо помилок немає, повторіть оригінальний текст.
Згенеруйте {num_corrections} різні варіанти виправленого тексту з поясненнями.
Екрануй всі символи подвійних лапок у відповіді зворотною косою рискою

Формат відповіді у JSON:
[{{
    "correction": "виправлений текст",
    "explanation": "пояснення до виправлення"
}}, ...]

Приклади:

1. Вхідний текст:
   Останні 3 місяці мого життя видалися аж занадто насиченими на події та емоції, але ось нарешті у мене з’явилося декілька вільних годин та трохи енергії щоб продовжити серію записів щодо мого досвіду блогерства.

   Виправлення:
   [("Останні три місяці мого життя були надзвичайно насиченими подіями та емоціями, але нарешті у мене з’явилося кілька вільних годин та трохи енергії, щоб продовжити серію записів щодо свого досвіду блогерства.", "Замінено '3' на 'три' для узгодженості стилю; замінено 'декілька' на 'кілька' для кращого стилю; додано кому після 'енергії' відповідно до правил пунктуації; замінено 'мого' на 'свого' для стилістичної узгодженості."),
   ("Протягом останніх трьох місяців моє життя було надзвичайно насиченим подіями та емоціями, але тепер у мене з’явилося кілька вільних годин і трохи енергії, щоб продовжити серію записів про свій досвід блогерства.", "Перефразовано речення для кращої читабельності; виправлено пунктуацію та займенники для узгодження."),
   ("Після трьох дуже насичених місяців нарешті знайшов кілька вільних годин та трохи енергії, щоб продовжити серію записів про свій блогерський досвід.", "Скорочено та спрощено речення; виправлено стилістичні помилки для покращення читання.")]

2. Вхідний текст:
   Мені завжди було цікаво читати статті про життя закордоном. Але в них, на мій погляд, завжди не вистачало системності.

   Виправлення:
   [("Мені завжди було цікаво читати статті про життя за кордоном. Але їм, як на мене, завжди бракувало систематичності.", "Виправлено орфографічну помилку 'закордоном' на 'за кордоном'; замінено 'в них' на 'їм' для правильного відмінка; замінено фразу 'на мій погляд' на 'як на мене' для кращого стилю; замінено 'не вистачало' на 'бракувало'; змінено 'системності' на 'систематичності' для точнішого вираження."),
   ("Я завжди цікавився статтями про життя за кордоном, але, як на мене, їм завжди бракувало систематичності.", "Перебудовано речення для кращої стилістики; виправлено орфографію та граматичні помилки."),
   ("Мені було цікаво читати про життя за кордоном, але, як на мене, ці статті завжди бракували систематичності.", "Спрощено речення; виправлено помилки та покращено плавність викладу.")]

3. Вхідний текст:
   Не знаю як у інших, а у мене в житті траплялось не так багато див.

   Виправлення:
   [("Не знаю, як у інших, а у мене в житті траплялось не так багато див.", "Додано кому після 'не знаю' згідно з правилами пунктуації."),
   ("Не знаю, як в інших, а у мене в житті траплялося не так багато чудес.", "Додано кому; замінено 'у інших' на 'в інших'; виправлено форму дієслова; замінено 'див' на 'чудес' для кращої лексичної відповідності."),
   ("Не знаю, як у інших, але в моєму житті не було багато чудес.", "Додано кому; перебудовано речення для більшої зрозумілості.")]

4. Вхідний текст:
   Я навіть писав про свої співбесіди та роботу, власні думки.

   Виправлення:
   [("Я навіть писав про свої співбесіди, роботу та власні думки.", "Додано кому для правильного розділення переліку."),
   ("Я навіть писав про свої співбесіди, роботу і власні думки.", "Додано сполучник 'і' для завершення переліку."),
   ("Я навіть ділився власними думками та писав про співбесіди і роботу.", "Перебудовано речення для покращення стилю.")]

5. Вхідний текст:
   Мама сказала завтра ми підемо в парк

   Виправлення:
   [("Мама сказала: «Завтра ми підемо в парк».", "Додано двокрапку після 'сказала'; оформлено пряму мову в лапках; початок прямої мови з великої літери."),
   ("Мама сказала, що завтра ми підемо в парк.", "Перетворено пряму мову на непряму; додано кому після 'сказала'."), 
   ("«Завтра ми підемо в парк», — сказала мама.", "Пряма мова поставлена перед словами автора; додано кому і тире після лапок згідно з правилами пунктуації; слова автора з малої літери.")]

6. Вхідний текст:

   Третій спосіб, на котрий витрачають час звичайні користувачі – лайки та підписки на інших користувачів у надії на те, що ті підпишуться у відповідь.

   Виправлення:
   [("Третій спосіб, на який витрачають час звичайні користувачі, — вподобання та підписки на інших користувачів у надії, що ті підпишуться у відповідь.", "Замінено 'на котрий' на 'на який' для граматичної правильності; додано тире для відокремлення пояснення; замінено 'лайки' на 'вподобання' для уникнення кальки."),
   ("Третій спосіб, на який звичайні користувачі витрачають час,— це вподобання та підписування на інших користувачів з надією, що ті підпишуться у відповідь.", "Перебудовано речення для покращення стилю; виправлено кальки та пунктуацію."),
   ("Звичайні користувачі часто витрачають час на вподобання і підписки на інших у надії на взаємність.", "Спрощено речення; виправлено стилістичні помилки та покращено зрозумілість.")]

7. Вхідний текст:
   Я відразу ж вирішив, що буду буду писати все як є, щоб не вийшло такого, знаєте, ідеального Instagram, що показує лише приємні моменти.

   Виправлення:
   [("Я відразу вирішив, що писатиму все як є, щоб не вийшов такий, знаєте, ідеальний Instagram, який показує лише приємні моменти.", "Видалено зайве 'буду'; виправлено форму дієслова на 'писатиму'; замінено 'що' на 'який' для правильної сполучникової зв'язки."),
   ("Я одразу вирішив писати все як є, щоб не створити ідеальний Instagram, який показує лише приємні моменти.", "Спрощено та покращено речення; виправлено граматичні помилки."),
   ("Я вирішив відразу, що писатиму все без прикрас, щоб не створювати ідеальний Instagram, який показує тільки приємні моменти.", "Переформульовано для кращого стилю; виправлено помилки та покращено лексичний вибір.")]

8. Вхідний текст:
   Сьогодні ми відвідали музей НАНУ, а потім пішли до кафе поруч з КМДА.

   Виправлення: 
   [("Сьогодні ми відвідали музей НАН України, а потім пішли до кафе поруч із КМДА.", "Розшифровано абревіатуру 'НАНУ' на 'НАН України' для точності; додано прийменник 'із' перед 'КМДА' для граматичної правильності."),
   ("Сьогодні ми відвідали музей Національної академії наук України, а потім пішли до кафе поруч із Київською міською державною адміністрацією.", "Повністю розшифровано абревіатури 'НАНУ' та 'КМДА' для ясності та офіційності; додано прийменник 'із' для правильної конструкції."),
   ("Сьогодні ми відвідали музей НАН України, а потім пішли до кафе біля КМДА.", "Розшифровано 'НАНУ' на 'НАН України'; замінено 'поруч з' на 'біля' для кращої стилістики.")]

Вхідний текст: {original_text}
Виправлення:"""
    input_variables: list[str] = ["original_text", "num_corrections"]


class GrammarErrorCorrectionAggregationPrompt(BasePrompt):
    template: str = """Агрегуйте запроповані граматичні виправлення тексту у фінальний граматично правильний текст.
З оригінального тексту та списку з {num_corrections} варіантів його виправлення, об'єднай всі корисні виправлення з цих варіантів та створи фінальний виправлений текст.
Усунь орфографічні, пунктуаційні, стилістичні, граматичні, лексичні та синтаксичні помилки.
Добав пояснення до агрегованих виправлень та граматичної корекції тексту.
Сфокосуйся на запропонованих виправленнях, та не старайся виправити оригінальний текст самотужки.
Якщо помилок немає, поверни оригінальний текст.
Екрануй всі символи подвійних лапок у відповіді зворотною косою рискою

Формат запропонованих виправленнь:
[{{
    "correction": "виправлений текст",
    "explanation": "пояснення до виправлення"
}},...]

[Output only JSON]
Формат відповіді у JSON:
{{
    "correction": "виправлений текст",
    "explanation": "пояснення до виправлення"
}}

Оригінальний текст: {original_text}
Запропоновані виправлення: {possible_corrections}
Виправлений текст:"""

    input_variables: list[str] = ["original_text", "possible_corrections", "num_corrections"]
