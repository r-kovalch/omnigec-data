from src.prompts.base_prompts import BasePrompt


class MultiGrammarErrorCorrectionGenerationPrompt(BasePrompt):
    template: str = """Виправте наступний текст, зробивши його граматично правильним.
Виправте всі орфографічні, пунктуаційні, стилістичні, граматичні, лексичні та синтаксичні помилки.
Якщо помилок немає, повторіть оригінальний текст.
Згенеруйте {num_corrections} різні варіанти виправленого тексту з поясненнями.
Екрануй всі символи подвійних лапок, та інші спеціальні символи у відповіді двома зворотними косими рисками.
До прикладу, замість нового рядка - символ \\n; замість " - екранований символ \\"
Будь ласка, не видаляй технічні символи, такі як інтернет посилання, теги, тощо з інших мов (переважно англійська).


Формат відповіді у JSON:
[{{
    "correction": "виправлений текст",
    "explanation": "пояснення до виправлення"
}}, ...]

Приклади:

1. Вхідний текст:
   Останні 3 місяці мого життя видалися аж занадто насиченими на події та емоції, але ось нарешті у мене з’явилося декілька вільних годин та трохи енергії щоб продовжити серію записів щодо мого досвіду блогерства.

   Виправлення:
   [("Останні три місяці мого життя були надзвичайно насиченими подіями та емоціями, але нарешті у мене з’явилося кілька вільних годин та трохи енергії, щоб продовжити серію записів щодо свого досвіду блогерства.", "Замінено '3' на 'три' для узгодженості стилю; замінено 'декілька' на 'кілька' для кращого стилю; додано кому після 'енергії' відповідно до правил пунктуації; замінено 'мого' на 'свого' для стилістичної узгодженості."),
   ("Протягом останніх трьох місяців моє життя було надзвичайно насиченим подіями та емоціями, але тепер у мене з’явилося кілька вільних годин і трохи енергії, щоб продовжити серію записів про свій досвід блогерства.", "Перефразовано речення для кращої читабельності; виправлено пунктуацію та займенники для узгодження."),
   ("Після трьох дуже насичених місяців нарешті знайшов кілька вільних годин та трохи енергії, щоб продовжити серію записів про свій блогерський досвід.", "Скорочено та спрощено речення; виправлено стилістичні помилки для покращення читання.")]

2. Вхідний текст:
   Мені завжди було цікаво читати статті про життя закордоном. Але в них, на мій погляд, завжди не вистачало системності.

   Виправлення:
   [("Мені завжди було цікаво читати статті про життя за кордоном. Але їм, як на мене, завжди бракувало систематичності.", "Виправлено орфографічну помилку 'закордоном' на 'за кордоном'; замінено 'в них' на 'їм' для правильного відмінка; замінено фразу 'на мій погляд' на 'як на мене' для кращого стилю; замінено 'не вистачало' на 'бракувало'; змінено 'системності' на 'систематичності' для точнішого вираження."),
   ("Я завжди цікавився статтями про життя за кордоном, але, як на мене, їм завжди бракувало систематичності.", "Перебудовано речення для кращої стилістики; виправлено орфографію та граматичні помилки."),
   ("Мені було цікаво читати про життя за кордоном, але, як на мене, ці статті завжди бракували систематичності.", "Спрощено речення; виправлено помилки та покращено плавність викладу.")]

3. Вхідний текст:
   Не знаю як у інших, а у мене в житті траплялось не так багато див.

   Виправлення:
   [("Не знаю, як у інших, а у мене в житті траплялось не так багато див.", "Додано кому після 'не знаю' згідно з правилами пунктуації."),
   ("Не знаю, як в інших, а у мене в житті траплялося не так багато чудес.", "Додано кому; замінено 'у інших' на 'в інших'; виправлено форму дієслова; замінено 'див' на 'чудес' для кращої лексичної відповідності."),
   ("Не знаю, як у інших, але в моєму житті не було багато чудес.", "Додано кому; перебудовано речення для більшої зрозумілості.")]

4. Вхідний текст:
   Я навіть писав про свої співбесіди та роботу, власні думки.

   Виправлення:
   [("Я навіть писав про свої співбесіди, роботу та власні думки.", "Додано кому для правильного розділення переліку."),
   ("Я навіть писав про свої співбесіди, роботу і власні думки.", "Додано сполучник 'і' для завершення переліку."),
   ("Я навіть ділився власними думками та писав про співбесіди і роботу.", "Перебудовано речення для покращення стилю.")]

5. Вхідний текст: Моя сестра старше мене на три роки, але ми дуже добре ладнаємо.

    Виправлення: 
    [("Моя сестра старша за мене на три роки, але ми дуже добре ладнаємо.", "Замінено 'старше' на 'старша' для узгодження роду; додано прийменник 'за' відповідно до граматичних правил."),
    ("Хоча моя сестра на три роки старша за мене, ми дуже добре ладнаємо.", "Перебудовано речення для покращення стилістики; виправлено граматичні помилки."),
    ("Ми з сестрою, яка старша за мене на три роки, дуже добре ладнаємо.", "Перефразовано речення; додано уточнення для покращення зв'язності.")]

6. Вхідний текст:

   Третій спосіб, на котрий витрачають час звичайні користувачі – лайки та підписки на інших користувачів у надії на те, що ті підпишуться у відповідь.

   Виправлення:
   [("Третій спосіб, на який витрачають час звичайні користувачі, — вподобання та підписки на інших користувачів у надії, що ті підпишуться у відповідь.", "Замінено 'на котрий' на 'на який' для граматичної правильності; додано тире для відокремлення пояснення; замінено 'лайки' на 'вподобання' для уникнення кальки."),
   ("Третій спосіб, на який звичайні користувачі витрачають час,— це вподобання та підписування на інших користувачів з надією, що ті підпишуться у відповідь.", "Перебудовано речення для покращення стилю; виправлено кальки та пунктуацію."),
   ("Звичайні користувачі часто витрачають час на вподобання і підписки на інших у надії на взаємність.", "Спрощено речення; виправлено стилістичні помилки та покращено зрозумілість.")]

7. Вхідний текст:
   Я відразу ж вирішив, що буду буду писати все як є, щоб не вийшло такого, знаєте, ідеального Instagram, що показує лише приємні моменти.

   Виправлення:
   [("Я відразу вирішив, що писатиму все як є, щоб не вийшов такий, знаєте, ідеальний Instagram, який показує лише приємні моменти.", "Видалено зайве 'буду'; виправлено форму дієслова на 'писатиму'; замінено 'що' на 'який' для правильної сполучникової зв'язки."),
   ("Я одразу вирішив писати все як є, щоб не створити ідеальний Instagram, який показує лише приємні моменти.", "Спрощено та покращено речення; виправлено граматичні помилки."),
   ("Я вирішив відразу, що писатиму все без прикрас, щоб не створювати ідеальний Instagram, який показує тільки приємні моменти.", "Переформульовано для кращого стилю; виправлено помилки та покращено лексичний вибір.")]

8. Вхідний текст:
   Ми збираємося поїхати в Карпати на наступному тижні, якщо буде хороша погода.

   Виправлення: 
   [("Ми збираємося поїхати до Карпат наступного тижня, якщо буде гарна погода.", "Замінено 'в Карпати' на 'до Карпат' для правильного використання прийменника; замінено 'на наступному тижні' на 'наступного тижня'; замінено 'хороша' на 'гарна' відповідно до стилістичних норм."),
   ("Якщо погода буде гарною, ми плануємо поїздку до Карпат наступного тижня.", "Перебудовано речення для покращення стилю; використано 'гарною' замість 'хороша'; замінено 'збираємося поїхати' на 'плануємо поїздку'."),
   ("Наступного тижня ми поїдемо до Карпат, якщо буде гарна погода.", "Скорочено речення для чіткості; виправлено пунктуацію та використання прийменників.")]

9. Вхідний текст:
   Він працює в цій компанії вже більше п'яти років, але досі не отримав підвищення.

   Виправлення: 
   [("Він працює в цій компанії вже понад п’ять років, але досі не отримав підвищення.", "Замінено 'більше' на 'понад' для правильного вживання з числівниками."),
   ("Він уже п’ять років працює в цій компанії, але досі не був підвищений.", "Переставлено слова для покращення стилю; замінено 'отримав підвищення' на 'був підвищений' для різноманітності."),
   ("Працюючи в цій компанії понад п’ять років, він досі не отримав підвищення.", "Перебудовано речення для кращої стилістики; використано дієприкметниковий зворот.")]

10. Вхідний текст:
    Я завжди вважав, що вчитися програмуванню потрібно здебільшого на практиці. Ключовий момент - не лише розвʼязувати задачі чи вправи з підручника, а й займатися реальним проектом. Це може бути будь-що, що вам цікаво і (бажано) потрібно: калькулятор для улюбленої гри. Адже це вам буде 'треба', а не 'для галочки'.

    Виправлення: 
    [("Я завжди вважав, що вчитися програмуванню потрібно здебільшого на практиці. Тут головне — не лише розв’язувати задачі чи вправи з підручника, а й займатися реальним проєктом. Це може бути будь-що, що вам цікаво і бажано потрібно: калькулятор для улюбленої гри. Адже це вам буде потрібно, а не 'для галочки'.", "Замінено 'Ключовий момент' на 'Тут головне' для покращення стилістики; прибрано дужки навколо 'бажано' як непотрібні; виправлено 'проект' на 'проєкт'; прибрано зайві лапки навколо 'треба' та замінено його на 'потрібно' для більш літературного стилю." ), 
    ("Я завжди вважав, що програмуванню слід навчатися переважно на практиці. Важливо не тільки розв’язувати вправи з підручника, а й працювати над реальним проєктом. Це може бути щось цікаве і потрібне вам: калькулятор для улюбленої гри. Адже це вам буде потрібно, а не просто 'для галочки'.", "Перефразовано речення для покращення стилю; замінено 'Ключовий момент' на 'Важливо'; виправлено 'проект' на 'проєкт'; прибрано дужки; виправлено 'треба' на 'потрібно'; збережено лапки навколо 'для галочки' для підкреслення фразеологізму." ), 
    ("На мою думку, програмування найкраще вивчати на практиці. Основне — не тільки розв’язувати вправи з підручника, а й займатися реальними проєктами. Це може бути все, що вас цікавить і є для вас потрібним: калькулятор для улюбленої гри. Адже це дійсно стане вам у пригоді, а не лише 'для галочки'.", "Перебудовано речення для кращої читабельності; замінено 'Ключовий момент' на 'Основне'; виправлено 'проект' на 'проєкт'; прибрано дужки; замінено 'треба' на 'потрібно'; використано фразеологізм 'стати у пригоді'; збережено лапки навколо 'для галочки' як фразеологізм." )]

Вхідний текст: {text}
Виправлення:"""


class GrammarErrorCorrectionAggregationPrompt(BasePrompt):
    template: str = """Агрегуйте запроповані граматичні виправлення тексту у фінальний граматично правильний текст.
З оригінального тексту та списку з {num_corrections} варіантів його виправлення, об'єднай всі корисні виправлення з цих варіантів та створи фінальний виправлений синтаксично коректний текст.
Усунь орфографічні, пунктуаційні, стилістичні, граматичні, лексичні та синтаксичні помилки.
Добав пояснення до агрегованих виправлень та граматичної корекції тексту.
Сфокосуйся на запропонованих виправленнях, та не старайся виправити оригінальний текст самотужки.
Якщо помилок немає, поверни оригінальний текст.
Екрануй всі символи подвійних лапок, та інші спеціальні символи у відповіді двома зворотними косими рисками.
До прикладу, замість нового рядка - символ \\n; замість " - екранований символ \\"
Будь ласка, не видаляй технічні символи, такі як інтернет посилання, теги, тощо з інших мов (переважно англійська).


Формат запропонованих виправленнь:
[{{
    "correction": "виправлений текст",
    "explanation": "пояснення до виправлення"
}},...]

[Output only JSON]
Формат відповіді у JSON:
{{
    "correction": "виправлений текст",
    "explanation": "пояснення до виправлення"
}}

Оригінальний текст: {text}
Запропоновані виправлення: {possible_corrections}
Виправлений текст:"""
    input_variables: list[str] = ["text", "possible_corrections", "num_corrections"]
